# 第10部分 特殊语法

---

## 1> var隐式类型

- 可以用来表示任意类型的变量，但不能作为类的成员，只能用于临时变量声明时，一般写在函数的语句块中，且必须初始化。

---

## 2> 设置对象初始化

- 可以通过直接构造方式，可以通过直接写大括号的形式初始化公共成员变量和属性。

    classA ca = new classA(){ 成员初始化 }；

- 对于数组类型可以直接={  }赋值；

---

## 3> 匿名类型

- var  n = new{ age = 15，money = 200，Name = “Jimry” }

---

## 4> 可空类型

- object？等。

---

### 4.1 判断是否为空的方法

- if（obj.hasvalue）{ cw(obj.value);  }

---

### 4.2 安全获取可空类型值

- 如果为空，默认返回值为类型的默认值。

    obj.GetValueOrDefault( );//是可空类的方法

- 或指定默认值  obj.GetValueOrDefault（value）；//当为空时，返回value

- if（obj != ）{obj.ToString(); }  或  obj ?. ToString();

- obj ?? default；空合并

---

## 5> 单句逻辑的简略写法

- 当语句关键字的语句块只有一行代码时，大括号可以省略。

- 属性中get与set只有一句语句用=>简略

- 函数方法体只有一句时，使用表达式作为主体表示方法，=>

---

## 6> 值和引用规则

- 值类型内容在栈内存上，引用类型内容在堆内存上。

---

### 6.1 语句块概念

![图片](.\assets\10_6.png)

- 逻辑代码写在函数等中层语句块以及底层语句块中
- 变量声明在：上层语句块中（成员变量）、中层、底层语句块中（局部/临时）

---

### 6.2 变量的生命周期

- 编译时大部分都是临时变量，在中底层声明的临时变量（函数，条件分支，循环语句）；语句块执行结束，没有被记录的对象被回收或变成垃圾，值类型自动回收，引用类型在栈上存地址的房间被系统自动回收，而堆中具体内容变成垃圾，待下次GC回收。

- 若不想被回收变成垃圾，必须将其记录下来，比如在更高级的语句块中记录或者使用静态全局变量记录。

---

### 6.3 结构体中的值和引用

- 结构体本身时值类型（前提是该结构体没有作为其他类的成员）

- 结构体中的值在栈中存储具体的内容，引用在栈中存地址，在堆中存储引用具体的内容。

---

### 6.4 类中的值和引用

- 类是引用类型，当类对象定义声明后，在堆中开辟一块空间，将其值和引用的地址存在其中，引用的具体内容单独开辟空间在堆中，并由类对象具体内容中的引用地址去指向该单独空间，而类对象本身把堆中开辟空间的地址存在栈中。

---

### 6.5 数组中的存储规则

- 值类型在堆中房间存具体内容，引用类型堆中房间存地址，地址为null或者指向堆中的某一块单独内存。

---

## 7> 结构体继承接口

- 利用里氏替换原则，用接口容器转载结构体存在装箱拆箱，即结构体中的之转向从栈移到堆中，从值类型转换成引用类型。

---
